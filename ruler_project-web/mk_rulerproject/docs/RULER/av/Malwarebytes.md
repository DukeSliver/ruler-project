# Malwarebytes

## Event logs

Unknown at this time 

## Windows Registry

Have not identified anything other than settings related to detections. Further research required.

## Application specific files

- Name: MalwareBytes Anti-Malware Logs
  - Path: C:\ProgramData\Malwarebytes\Malwarebytes Anti-Malware\Logs\mbam-log-*.xml'
- Name: MalwareBytes Anti-Malware Service Logs
  - Path: C:\ProgramData\Malwarebytes\MBAMService\logs\mbamservice.log*
  - Notes: Indicates the timezone in the log file - appears that the log is recorded in Local time as per this entry.
- Name: MalwareBytes Anti-Malware Scan Logs
  - Path: C:\Users\%user%\AppData\Roaming\Malwarebytes\Malwarebytes Anti-Malware\Logs\
- Name: MalwareBytes Anti-Malware Scan Results Logs
  - Path: C:\ProgramData\Malwarebytes\MBAMService\ScanResults
  - Notes: contains JSON output of the scan results

### Searching with Powershell

* Path: C:\ProgramData\Malwarebytes\MBAMService\LOGS
  - select-string -pattern "Threat Detected" * 
  - Log format:

  ``` yaml
  Date	Time	Tick Count	Process ID	Thread ID	Log Level	Context Tag	Function Name	File Name	Line Number	Message
  MM/DD/YY	" HH:MM:SS.SSS"	650968	108c	1a9c	ERROR		DdsClassifyObject	"ddsmbsdk"	454	"MBAMService(454) - 2020/05/07 - 11:21:10 - #1# - Error 9 DdsScanFile: C:\XYZ\MIMIX32\MIMIDRV.SYS - 	30 - 0 - 6812 - 4236"
  ```

## Quarantine

* Path: \ProgramData\Malwarebytes\MBAMService\Quarantine
* Filename <GUID>.quar or <GUID>.data
* Notes: Sometimes the GUIDs for quar and data match but not always. Unsure why.

## References

* [Malwarebytes Malware Remediation User Guide](https://www.malwarebytes.com/pdf/guides/MBMRGuideA.pdf)